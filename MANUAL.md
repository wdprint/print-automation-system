# 📖 인쇄 자동화 시스템 v2.0 사용자 매뉴얼

## 목차
1. [시스템 소개](#1-시스템-소개)
2. [설치 가이드](#2-설치-가이드)
3. [빠른 시작](#3-빠른-시작)
4. [기본 사용법](#4-기본-사용법)
5. [고급 기능](#5-고급-기능)
6. [설정 관리](#6-설정-관리)
7. [문제 해결](#7-문제-해결)
8. [단축키 참조](#8-단축키-참조)

---

## 1. 시스템 소개

### 📌 주요 기능
인쇄 자동화 시스템은 PDF 의뢰서에 썸네일과 QR 코드를 자동으로 삽입하는 스마트 자동화 도구입니다.

#### ✨ 핵심 기능
- **자동 파일 매칭**: 의뢰서, 썸네일, QR 자동 인식
- **대기열 시스템**: 여러 세트 순차 처리
- **백지 감지**: 빈 페이지 자동 건너뛰기
- **프리셋 관리**: 작업별 설정 저장/불러오기
- **처리 규칙**: 파일명 패턴 자동 처리

#### 🆕 v2.0 새로운 기능
- 다중 페이지 썸네일 지원
- 이미지 효과 (흑백, 대비, 선명도)
- 멀티스레딩 지원
- 실시간 통계 추적
- 향상된 백지 감지 알고리즘

---

## 2. 설치 가이드

### 📋 시스템 요구사항
- **운영체제**: Windows 10/11 (64비트)
- **Python**: 3.8 이상 (개발 환경)
- **AutoHotkey**: v2.0 이상 (자동화용)
- **메모리**: 4GB 이상 권장
- **저장공간**: 500MB 이상

### 🔧 설치 방법

#### 방법 1: 빠른 설치 (권장)
```bash
# 1. 설치 스크립트 실행
start_enhanced.py

# 2. 필요한 패키지 자동 설치 확인
# 3. 프로그램 자동 실행
```

#### 방법 2: 수동 설치
```bash
# 1. Python 패키지 설치
pip install tkinterdnd2 PyMuPDF Pillow numpy

# 2. AutoHotkey 설치
# https://www.autohotkey.com 에서 다운로드

# 3. 프로그램 실행
python print_automation_enhanced.py
```

#### 방법 3: EXE 빌드 및 배포
```bash
# 1. 빌드 스크립트 실행
build_enhanced.bat

# 2. dist 폴더로 이동
cd dist

# 3. 실행
run_enhanced.bat
```

---

## 3. 빠른 시작

### 🚀 3단계로 시작하기

#### Step 1: 파일 준비
필요한 파일 3개를 준비합니다:
- 📄 **의뢰서 PDF** (파일명에 "의뢰서" 포함)
- 📄 **인쇄 데이터 PDF** (썸네일용)
- 🖼️ **QR 코드 이미지** (JPG/PNG)

#### Step 2: 프로그램 실행
```bash
# GUI 모드
python print_automation_enhanced.py

# 또는 자동화 모드 (AutoHotkey)
AutoHotkey.exe 의뢰서첨부_향상된버전.ahk
```

#### Step 3: 파일 처리
- **GUI 모드**: 파일을 드래그 앤 드롭
- **자동화 모드**: 파일 선택 후 F3 키 누르기

---

## 4. 기본 사용법

### 📁 파일 처리 방법

#### GUI 모드 (드래그 앤 드롭)
1. 프로그램 실행
2. 흰색 영역에 파일 3개 드롭
3. 자동 처리 시작
4. 완료 메시지 확인

#### 자동화 모드 (단축키)
1. AutoHotkey 스크립트 실행
2. Windows 탐색기에서 파일 선택
3. **F3** 키 누르기
4. 처리 완료 알림 확인

### 📊 대기열 시스템

#### 대기열 작동 방식
```
파일 추가 → 자동 매칭 → 대기열 등록 → 순차 처리
```

#### 대기열 관리
- **Shift+F3**: 대기열 상태 보기
- **Ctrl+Shift+R**: 현재 세트 초기화
- **Ctrl+Shift+Alt+R**: 전체 대기열 초기화

### 🎨 프리셋 시스템

#### 프리셋 사용
- **Alt+1~4**: 프리셋 1~4 즉시 전환
- 각 프리셋은 다른 위치/크기 설정 저장

#### 프리셋 설정
1. **Ctrl+Alt+F3**으로 고급 설정 열기
2. "프리셋 관리" 탭 선택
3. 현재 설정을 프리셋으로 저장

---

## 5. 고급 기능

### 📄 백지 감지

#### 설정 방법
1. 고급 설정 열기 (**Ctrl+Alt+F3**)
2. "백지 감지" 탭 선택
3. 옵션 설정:
   - **임계값**: 80~100% (높을수록 엄격)
   - **알고리즘**: 
     - 단순 (빠름)
     - 엔트로피 (정확)
     - 히스토그램 (균형)
   - **제외 영역**: 헤더/푸터/여백 픽셀

#### 사용 예시
```
✅ 백지 감지 ON
임계값: 95%
알고리즘: 엔트로피
→ 페이지 2, 5 건너뜀 (백지)
```

### 🖼️ 썸네일 처리 옵션

#### 다중 페이지 썸네일
- **페이지 선택 문법**:
  - `1`: 첫 페이지만
  - `1-3`: 1~3페이지
  - `1,3,5`: 선택 페이지
  - `1-3,5,7-9`: 복합 선택

#### 이미지 효과
- **흑백 변환**: 컬러 → 흑백
- **대비 조정**: 0.5~2.0 (1.0 = 원본)
- **선명도**: 0.5~2.0 (1.0 = 원본)

### ⚙️ 처리 규칙 엔진

#### 규칙 생성
1. "처리 규칙" 탭 열기
2. 새 규칙 추가:
   - **규칙 이름**: 표지 자동 크롭
   - **파일명 패턴**: `표지|cover`
   - **동작**: `crop_right_half`
   - **프리셋**: (선택사항)

#### 규칙 예시
| 패턴 | 동작 | 설명 |
|------|------|------|
| `표지` | `crop_right_half` | 오른쪽 50% 크롭 |
| `draft` | `force_grayscale` | 강제 흑백 변환 |
| `urgent` | `skip_blank_pages` | 백지 건너뛰기 |

### 🚀 성능 최적화

#### 멀티스레딩
- **동시 처리 파일 수**: 1~10 설정 가능
- CPU 코어 수에 따라 자동 조정

#### 캐싱 시스템
- **캐시 크기**: 10~500MB
- 백지 감지 결과 캐싱
- 반복 작업 속도 향상

---

## 6. 설정 관리

### ⚙️ 설정 파일 구조

#### 1. enhanced_settings.json
```json
{
  "thumbnail": {
    "positions": [...],
    "multi_page": false,
    "grayscale": false
  },
  "blank_detection": {
    "enabled": true,
    "threshold": 95
  },
  "processing_rules": {...},
  "performance": {...}
}
```

#### 2. 설정파일.ini
```ini
[Hotkeys]
ProcessKey=F3
SettingsKey=^F3
EnhancedSettingsKey=^!F3

[General]
ShowTooltips=true
PlaySounds=true
```

#### 3. coord_presets.json
```json
{
  "1": {
    "name": "프리셋 1",
    "thumbnail": {...},
    "qr": {...}
  }
}
```

### 🔄 설정 백업/복원

#### 백업
```bash
# 모든 설정 백업
copy *.json backup\
copy *.ini backup\
```

#### 복원
```bash
# 백업에서 복원
copy backup\*.json .
copy backup\*.ini .
```

---

## 7. 문제 해결

### ❌ 일반적인 문제

#### "패키지를 설치해주세요" 오류
```bash
# 해결책
pip install tkinterdnd2 PyMuPDF Pillow numpy
```

#### "PrintProcessor가 정의되지 않았습니다" 오류
```bash
# 해결책
python start_enhanced.py  # 향상된 버전 사용
```

#### 파일이 인식되지 않을 때
- ✅ 의뢰서 PDF 파일명에 "의뢰서" 포함 확인
- ✅ 파일 확장자 확인 (.pdf, .jpg, .png)
- ✅ 파일 손상 여부 확인

#### 이미지가 제대로 삽입되지 않을 때
1. 설정에서 위치 조정
2. 샘플 PDF로 미리보기
3. 파일 암호화 확인

### 🔍 디버그 모드

#### 디버그 활성화
```python
# config.py 수정
DEBUG_MODE = True
```

#### 로그 확인
```bash
# 콘솔에서 상세 로그 확인
python print_automation.py > debug.log 2>&1
```

### 📞 지원

#### 문제 보고
1. 오류 메시지 전체 복사
2. 사용 환경 정보:
   - Windows 버전
   - Python 버전
   - 파일 형식
3. 재현 단계 설명

---

## 8. 단축키 참조

### 🎹 기본 단축키

| 단축키 | 기능 | 설명 |
|--------|------|------|
| **F3** | 파일 처리 | 선택한 파일 처리/대기열 추가 |
| **Shift+F3** | 대기열 보기 | 현재 대기열 상태 표시 |
| **F4** | 통계 보기 | 처리 통계 확인 |
| **F1** | 도움말 | 도움말 표시 |

### 🎨 프리셋 단축키

| 단축키 | 기능 |
|--------|------|
| **Alt+1** | 프리셋 1 |
| **Alt+2** | 프리셋 2 |
| **Alt+3** | 프리셋 3 |
| **Alt+4** | 프리셋 4 |

### ⚙️ 설정 단축키

| 단축키 | 기능 |
|--------|------|
| **Ctrl+F3** | 기본 설정 |
| **Ctrl+Alt+F3** | 고급 설정 |
| **Ctrl+Shift+R** | 현재 세트 초기화 |
| **Ctrl+Shift+Alt+R** | 전체 초기화 |

### 🔧 단축키 커스터마이징

1. `설정파일.ini` 열기
2. `[Hotkeys]` 섹션 수정
3. 프로그램 재시작

#### 단축키 문법
- `F3` = F3 키
- `^F3` = Ctrl+F3
- `+F3` = Shift+F3
- `!F3` = Alt+F3
- `^+F3` = Ctrl+Shift+F3

---

## 📝 부록

### 용어 설명

| 용어 | 설명 |
|------|------|
| **의뢰서** | 인쇄 주문서 PDF (2-up 레이아웃) |
| **썸네일** | 인쇄물 미리보기 이미지 |
| **QR 코드** | 추적용 QR 코드 이미지 |
| **프리셋** | 저장된 설정 모음 |
| **대기열** | 처리 대기 중인 파일 목록 |
| **백지 감지** | 빈 페이지 자동 인식 |

### 파일 구조
```
의뢰서 첨부/
├── print_automation_enhanced.py  # 메인 프로그램
├── enhanced_settings_gui.py      # 고급 설정 GUI
├── enhanced_print_processor.py   # 처리 엔진
├── enhanced_settings.json        # 설정 파일
├── coord_presets.json            # 프리셋
├── 설정파일.ini                  # 단축키
└── dist/
    ├── print_automation_enhanced.exe  # 실행 파일
    └── 의뢰서첨부_향상된버전.ahk     # AutoHotkey
```

### 버전 히스토리

| 버전 | 날짜 | 주요 변경사항 |
|------|------|--------------|
| v2.0 | 2024.01 | 향상된 기능 추가 |
| v1.5 | 2023.12 | 대기열 시스템 |
| v1.0 | 2023.11 | 초기 릴리즈 |

---

## 💡 팁과 트릭

### 생산성 향상 팁

1. **프리셋 활용**
   - 자주 사용하는 설정을 프리셋으로 저장
   - Alt+1~4로 빠른 전환

2. **대량 처리**
   - 여러 세트를 미리 준비
   - 대기열에 추가 후 자동 처리

3. **처리 규칙 설정**
   - 반복 작업 자동화
   - 파일명 패턴으로 자동 처리

4. **백지 감지 최적화**
   - 문서 유형별 임계값 조정
   - 알고리즘 선택으로 정확도 향상

### 권장 워크플로우

```
1. 파일 준비 (폴더별 정리)
   ↓
2. 프리셋 선택 (Alt+번호)
   ↓
3. 파일 선택
   ↓
4. F3 키로 처리
   ↓
5. 다음 세트 추가 (반복)
   ↓
6. 자동 순차 처리
```

---

📅 최종 업데이트: 2024년 1월
📧 문의: [지원 이메일]
🌐 문서: https://github.com/[프로젝트]

Copyright © 2024 인쇄 자동화 시스템. All rights reserved.